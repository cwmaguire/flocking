<html>
  <head>
    <script language="javascript">
      var boids = [];

      function go(){
        setInterval(function() {boids = animateBoids(boids, [])}, 1000);
      }

      function animateBoids(boids, newBoids){
        if(boids.length > 0){
          var newBoid = moveBoid(boids[0]);
          animateBoid(boid);
          var newBoids = newBoids.slice(0);
          newBoids.push(newBoid);
          animateBoids(boids.slice(1), newBoids);
        }else{
          return newBoids;
        }
      }

      function moveBoid(boid){
        var newVector = circleEdgesVector(boid);
        var combinedVector = combineVectors(newVector, boid.vector);
        var movedBoid = applyVector(boid, newVector);
        return movedBoid;
      }

      function circleEdgesVector(boid){
        return getRegionFun(boid).call(null, boid);
      }

      function getRegion(w, h, x, y){
        // concentric rings 1, 2, 3

        var mid = {x : w / 2, y : h / 2};
        var innerSquare = calcSquarePoints(w, h, 0.30);
        var middleSquare = calcSquarePoints(2, h, 0.70);
        //var columns = splitColumns(w, h, 0.15, 0.20, 0.30, 0.20, 0.15);
        //var rows = splitRows(w, h, 0.15, 0.20, 0.30, 0.20, 0.15);
        var columnSizes = [0.15, 0.20, 0.30, 0.20, 0.15];
        var rowSizes = [0.15, 0.20, 0.30, 0.20, 0.15];
        var regionCoords = regionCoords(w, h, x, y, columnSizes, rowSizes);
        var regionFuns = [[outTopLeft,
                            outMidLeft,
                            outMidLeft,
                            outMidLeft,
                            outBottomLeft],
                           [outTopMiddle,
                            midTopLeft,
                            midMidLeft,
                            midBottomLeft,
                            outBottomMiddle],
                           [outTopMiddle,
                            midTopMiddle,
                            center,
                            midBottomMiddle,
                            outBottomMiddle],
                           [outTopMiddle,
                            midTopRight,
                            center,
                            midBottomRight,
                            outBottomMiddle],
                           [outTopRight,
                            outMidRight,
                            outMidRight,
                            outMidRight,
                            outBottomRight]];
        return regionFun[regionCoords.x][regionCoords.y];

      }

      function regionCoords(x, y, w, h, columnSizes, rowSizes){
        var actualColumns = columnSizes(w, columnSizes);
        var actualRows = rowSizes(h, rowSizes);
        return {'x', getRegionColumn(x, w, actualColumns);
                'y', getRegionRow(y, h, actualRows)}
      }

      function regionRowOrColumn(xOrY, rowOrColNum, rowOrColSizes){
        if(xOrY < rowOrColSizes[0]){
          return rowOrColNumber;
        }else{
          return regionRowOrColumn(xOrY, rowOrColNumber + 1, rowOrColSizes.slice(1));
        }
      }

      function addBoid(){
        var canvas = document.getElementById("canvas1");
        var ctx = canvas.getContext("2d");

        drawBoids(ctx, 10, 40, 200, 10, 10);
      }

      function drawBoids(ctx, count, x, y, radius, radiusGrowth){
        if(count > 1){
          drawBoid(ctx, x + radius + 10, y, radius);
          drawBoids(ctx, count - 1, x + (radius * 2) + 20, y, radius + radiusGrowth, radiusGrowth);
        }
      }

      function drawBoid(ctx, x, y, r){
        ctx.fillStyle = "#000000";
        ctx.beginPath();
        ctx.arc(x, y, r, 1.75 * Math.PI, 1.25 * Math.PI);
        ctx.lineTo(x - r * 0.7, y - (0.6 * r)),
        ctx.lineTo(x, y - (r * 1.8)),
        ctx.lineTo(x + r * 0.7, y - (0.6 * r)),
        ctx.fill();
      }
    </script>
  </head>
  <!--<body onload="(function() {alert('Hey!')}).call(null)">-->
  <body>
    Text
    <button id="addBoid" onclick="addBoid()">Add Boid</button>
    <br>
    <canvas id="canvas1" width="600" height="600"></canvas>
  </body>
</html>
